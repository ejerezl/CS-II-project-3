\documentclass[t]{beamer}
\usetheme{Madrid}
\usecolortheme{seahorse}
\definecolor{seahorse}{RGB}{189, 186, 238}
\setbeamercolor{block title}{bg=seahorse,fg=black}

\usepackage{multicol}
\usepackage{tikz}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{tcolorbox}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{physics}
\usepackage{bm}
\usepackage{bbm}
\usepackage[export]{adjustbox}


\title{Error bounds for numerical approximations}
\author[MAT264] 
{Kaja Jurak, Esther Jerez}

\institute[UIB]
{
	Faculty of Mathematics\\
	University of Bergen
	
}
\date[2021]
{May 2021}


\logo{
	\begin{tikzpicture}
	\node[inner sep=0pt] (logo) at (0,0)
	{\includegraphics[width=.25\textwidth]{uiblogo.png}};
	\end{tikzpicture}}


\setlength\parindent{0pt}
\begin{document}
	\frame{\titlepage}
	\begin{frame}
	\frametitle{Introduction}
	Our main goal is to give accurate error bounds for approximated solutions of a PDE. In concrete, we will focus on the problem of the steady-state heat equation, described by  \alert{Poisson's equation}:
	\begin{align*}
	\bm{q} = -k \div ^2 u
	\end{align*}
	where 
	\begin{enumerate}
		\item[] $\bm{q}$ is the heat flux of the source,
		\item[] $k$ is the materials' thermal conductivity,
		\item[] $u$ is the temperature.
	\end{enumerate}
	With the previous PDE we will look at the flow rates or fluxes of energy locally. \\
	
	% \begin{block}{Remark}
	%     Sample text
	% \end{block}
	
\end{frame}

\begin{frame}
\frametitle{Introduction}
\begin{columns}[t]
	\column{0.5\textwidth}
	\textbf{1D CASE}
	\begin{align*}
	&\frac{\partial q}{\partial x} = f \\
	&q = -k \frac{\partial u}{\partial x} 
	\end{align*}
	And we will consider the following situations:
	\begin{itemize}
		\item[1.] Linear flux ($\frac{\partial q}{\partial x} = 1$) and constant thermal conductivity ($k=1$).
		\item[2.] Linear flux and thermal conductivity not constant.
		\item[3.] Flux non-linear ant thermal conductivity not constant.
	\end{itemize}
	
	\column{0.5\textwidth}
	\textbf{2D CASE} \\
	\begin{align*}
	\frac{\partial q_1}{\partial x} + \frac{\partial q_2}{\partial y}  &= f \\
	\bm{q} = (q_1,\; q_2)^T  &= -k \left( \frac{\partial T}{\partial x} ,\; \frac{\partial T}{\partial y}\right)^T
	\end{align*}
	Here we will consider a final problem where both $f$ and $k$ are more complex function, but we do know the real solution.
\end{columns}        
\end{frame}

\begin{frame}
\frametitle{Error bounds computations}
We are considering a general elliptic PDE:
\begin{align*}
\div q = f , \quad q =-k \div u
\end{align*}
Main idea: instead of measuring $\norm*{u-v} = \norm*{e_v}$, study $\norm*{k^{\frac{1}{2}}\div e_v}$. 
\\ By integrating the PDE and some more computations we obtain:
\begin{align*}
\norm*{k^{\frac{1}{2}}\div e:v} \leq \norm*{k^{-\frac{1}{2}}(\bm{r}+k\div v)} + C_{\Omega,k}\norm*{f-\div \bm{r}} \equiv \mathcal{M}(v,r;f)
\end{align*}
where $\bm{r}$ is an approximation to the flux function.
With this error bound, we will also consider the \alert{relative error}:
\begin{align*}
\frac{\norm*{k^{\frac{1}{2}}\div e_v}}{\norm*{k^{\frac{1}{2}}\div v}} \leq \frac{\mathcal{M}(v,r;f)}{\norm*{k^{\frac{1}{2}}\div v}}
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Error bounds computations}
When we do know the the real solution, we will also compute the \alert{efficiency index} (for the potential):
\begin{align*}
I_v = \frac{\mathcal{M}(v,r;f)}{\norm*{k^{\frac{1}{2}}\div e_v}}
\end{align*}
Combine the energy errors of both the potential and the flux:
\begin{align*}
\norm*{(e_v,e_r)}_{*} \equiv \norm*{k^{\frac{1}{2}}\div e_v} + \norm*{k^{-\frac{1}{2}}e_r} + C_{\Omega,k}\norm*{\div e_r}
\end{align*} 
And indeed, we can prove with the previous concepts that 
\begin{align*}
\mathcal{M}(v,r;f) \leq  \norm*{(e_v,e_r)}_{*}  \leq 3\mathcal{M}(v,r;f)
\end{align*}
respectively
\begin{align*}
1 \leq I_v^\ast = \frac{3\mathcal{M}(v,r;f) }{\norm*{(e_v,e_r)}_{*}} \leq 3
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Implementation of the method}
\begin{multicols}{2}[\columnsep2em] 
\includegraphics[width=\linewidth]{square.jpg}
\columnbreak

For each cell, we will approximate the potential ($v_h \approx u$), and the flux satisfies an integral form of conservation, so we can compute the flux ($r_h$) in every edge surrounding the cell using finite difference. Interpolating both flux and potential we can then obtain functions smooth enough to work with them. 
\end{multicols}

\end{frame}

\begin{frame}
\frametitle{Implementation of the method}

If we are considering the 1D case, following the conservation law for cell $i$ we have:
\begin{align*}
q_{i+1} - q_i =  \int_{w_i} f
\end{align*}

This can be applied the same way in the 2D case, component by component. For the particular case of a left side cell we would compute the flux on the left edge by:
\begin{align*}
F_L &= F_R - \int\limits_{x_1}^{x_2} f(x,y) \,dx\ \\
&=  F_R - f(x,y)\Delta x \quad \text{\scriptsize{(Cause we are considering f being constant)}}
\end{align*}
\end{frame}

\begin{frame}
\frametitle{Results in 1D }
%\begin{minipage}{0.8\textwidth}
\vspace{-18pt}
\begin{figure}[t]
%\centering
\includegraphics[width = 0.7\linewidth]{convergenceplot_k_f_constant.png}
\caption{Poisson equation in 1d with diffusivity $k(x) = 1$ and heat source $f(x) = 1$.}
\label{fig:Convergence1d1}
\end{figure}
\end{frame}

\begin{frame}{Result 1D}
\begin{figure}
\centering
\includegraphics[width = 1.05\linewidth, left]{difference_analytical_numerical.png}
\caption{Absolute difference between analytical and numerical solution of Poisson equation with $k(x) = 2-x$ and $f(x) = 4\pi^2\sin(2\pi x)\cdot k(x) + 2\pi\cos(2\pi x)$.}
\label{fig:fig:diff}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Results in 1D }
%\begin{minipage}{0.8\textwidth}
\vspace{-18pt}
\begin{figure}[t]
\centering
\includegraphics[width = 0.7\linewidth]{convergenceplot_k_f_non_constant.png}
\caption{Poisson equation in 1d with diffusivity $k(x) = 2-x$ and heat source $f(x) = 4\pi^2\sin(2\pi x)\cdot k(x) + 2\pi\cos(2\pi x)$.}
\label{fig:Convergence1d}
\end{figure}

% \end{minipage}
\end{frame}

\begin{frame}[c]
	\frametitle{Results in 2D}
	Data we work with:
	\begin{align*}
		f(x,y) &= 8\pi^2\sin{2\pi x}\sin{2\pi y}k(x,y) - 2\pi\cos{2\pi x}\sin{2\pi y}(y-1)+ \\ &2\pi\sin{2\pi x}\cos{2\pi y}(x-1) \\
		k(x,y) &= 1 + (x-1)(y-1) \\
		u(x,y) &= \sin(2\pi x)\sin(2\pi y)
	\end{align*}
	

\end{frame}
\begin{frame}
	\frametitle{Results in 2D}
	\begin{figure}
		\centering
        \includegraphics[width = 0.7\linewidth]{../../Images/convergence2d.jpg}
		\caption{Convergence of our method 2D}
    \end{figure}
\end{frame}

\begin{frame}[c]
    \frametitle{Results in 2D}
    \begin{table}[c]
          \begin{tabular}{c | c | c | c | c | c } 
            $\zeta$ & $\mathcal{M}$  & $\norm*{k^{\frac{1}{2}}\div e_v}$ & $\norm*{(e_v,e_r)}_{*}$ & $I_v^{eff}$ & $I_{v,r}^{eff}$ \\
            \hline \hline
            $\zeta_1$ (4) & 2.61 & 6.36e-1 & 2.99 & 4.10 & 2.62 \\ 
            $\zeta_2$ & 1.25 & 2.95e-1 & 1.43 & 4.26 & 2.63 \\
            $\zeta_3$ & 6.19e-1 & 1.43e-1& 7.03e-1 & 4.31 & 2.64 \\
            $\zeta_4$ & 3.07e-1 & 7.10e-2 & 3.48e-1 & 4.32 & 2.64 \\
          \end{tabular}
          \caption{2D - computations}
      \end{table}

\end{frame}

\begin{frame}
	\frametitle{Results in 2D}
	\begin{figure}[t]
		\centering
		\includegraphics[width = 0.7\linewidth]{../../Images/errorcomparison2d.jpg}
		\caption{Comparison of some quantities in 2D}
	\end{figure}
\end{frame}

\begin{frame}
\frametitle{Conclusion}
\begin{enumerate}
	\item Relative error measures the error respect the approximated solution, not the real solution.
	\item Can we really trust our method? Is it good enough?
	\item What if we don't know the real solution? We can not use the concept of efficiency index
	\item Would be interesting to implement a minorant for the energy error.
\end{enumerate}
\end{frame}

\begin{frame}
	\frametitle{References}
	\begin{enumerate}
		\item[I] Lecture Notes Mat264: Computational Science II, Univisersitet i Bergen, Jan Nordbotten, Spring Semester 2021.
		\item[II] Matlab files from Erlend.
		\item[III]  \href{https://en.wikipedia.org/wiki/Heat_equation\#Specific_examples}{Wikipedia Heat equation}
	\end{enumerate}
\end{frame}

\end{document}
